<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>App B·ªëc ThƒÉm ƒê·∫øm Ng∆∞·ª£c 25 L∆∞·ª£t</title>
    <style>
        :root { --primary: #2c3e50; --accent: #e74c3c; --success: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 20px; }
        .app-card { background: white; width: 100%; max-width: 450px; padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); overflow: hidden; position: relative; }
        
        h2 { text-align: center; color: var(--primary); margin-bottom: 25px; }
        
        /* Giao di·ªán nh·∫≠p qu√† */
        .input-list { display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
        .input-item { display: flex; align-items: center; gap: 10px; }
        .input-item label { width: 60px; font-size: 14px; font-weight: bold; }
        .input-item input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 8px; outline: none; }

        /* Giao di·ªán b·ªëc thƒÉm */
        #draw-ui { display: none; text-align: center; }
        .display-box { 
            margin: 25px 0; 
            padding: 50px 15px; 
            border: 2px solid #eee; 
            border-radius: 15px; 
            background: #fff; 
            min-height: 120px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Hi·ªáu ·ª©ng ƒë·∫øm ng∆∞·ª£c v√† k·∫øt qu·∫£ */
        #countdown { font-size: 60px; font-weight: bold; color: var(--accent); display: none; }
        #result-text { font-size: 28px; font-weight: bold; color: var(--success); display: none; z-index: 2; }
        .gift-icon { font-size: 50px; margin-bottom: 10px; transition: 0.3s; }
        
        /* Hi·ªáu ·ª©ng rung l·∫Øc */
        .shake { animation: shake 0.5s infinite; }
        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-5deg); }
            100% { transform: rotate(0deg); }
        }

        /* N√∫t b·∫•m */
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; cursor: pointer; font-size: 18px; font-weight: bold; transition: 0.3s; }
        .btn-start { background: var(--primary); color: white; }
        .btn-draw { background: var(--accent); color: white; box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3); }
        .btn:disabled { background: #ccc; box-shadow: none; cursor: not-allowed; }

        /* L·ªãch s·ª≠ */
        .history { margin-top: 25px; text-align: left; border-top: 1px solid #eee; padding-top: 15px; }
        #history-list { max-height: 120px; overflow-y: auto; background: #f9f9f9; padding: 10px; border-radius: 8px; font-size: 14px; }
    </style>
</head>
<body>

<div class="app-card">
    <div id="setup-ui">
        <h2>C√†i ƒë·∫∑t qu√† t·∫∑ng</h2>
        <div class="input-list" id="input-container"></div>
        <button class="btn btn-start" onclick="initApp()">B·∫Øt ƒë·∫ßu (25 l∆∞·ª£t b·ªëc)</button>
    </div>

    <div id="draw-ui">
        <h2 id="turn-title">L∆∞·ª£t c√≤n l·∫°i: 25</h2>
        <div class="display-box" id="box">
            <div id="gift-icon" class="gift-icon">üéÅ</div>
            <div id="countdown">3</div>
            <div id="result-text"></div>
        </div>
        <button id="draw-btn" class="btn btn-draw" onclick="startCountdown()">B·ªêC QU√Ä NGAY</button>
        
        <div class="history">
            <strong>L·ªãch s·ª≠:</strong>
            <div id="history-list"></div>
        </div>
        <button class="btn" style="margin-top:20px; background:none; color:#aaa; font-size:12px; text-decoration:underline" onclick="location.reload()">Reset l·∫°i ·ª©ng d·ª•ng</button>
    </div>
</div>

<script>
    const container = document.getElementById('input-container');
    let pool = [];
    let currentIdx = 0;

    // T·∫°o 10 √¥ nh·∫≠p
    for (let i = 1; i <= 10; i++) {
        container.innerHTML += `
            <div class="input-item">
                <label>Qu√† ${i}:</label>
                <input type="text" id="gift-${i}" value="M√≥n qu√† ${i}">
            </div>`;
    }

    function initApp() {
        const userGifts = [];
        for (let i = 1; i <= 10; i++) {
            userGifts.push(document.getElementById(`gift-${i}`).value || `Qu√† ${i}`);
        }

        // Logic 25 l∆∞·ª£t: M√≥n 1,2,3 (1 l·∫ßn), M√≥n 4 (2 l·∫ßn), 20 l∆∞·ª£t c√≤n l·∫°i (M√≥n 5-10)
        pool = [];
        pool.push(userGifts[0], userGifts[1], userGifts[2], userGifts[3], userGifts[3]);
        for (let i = 0; i < 20; i++) {
            let rand = Math.floor(Math.random() * 6) + 4; 
            pool.push(userGifts[rand]);
        }

        // X√°o tr·ªôn
        for (let i = pool.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [pool[i], pool[j]] = [pool[j], pool[i]];
        }

        document.getElementById('setup-ui').style.display = 'none';
        document.getElementById('draw-ui').style.display = 'block';
    }

    function startCountdown() {
        const btn = document.getElementById('draw-btn');
        const countEl = document.getElementById('countdown');
        const giftIcon = document.getElementById('gift-icon');
        const resultEl = document.getElementById('result-text');
        
        btn.disabled = true;
        resultEl.style.display = 'none';
        giftIcon.style.display = 'block';
        giftIcon.classList.add('shake');
        countEl.style.display = 'block';

        let count = 3;
        countEl.innerText = count;

        const timer = setInterval(() => {
            count--;
            if (count > 0) {
                countEl.innerText = count;
            } else {
                clearInterval(timer);
                showResult();
            }
        }, 800);
    }

    function showResult() {
        const giftIcon = document.getElementById('gift-icon');
        const countEl = document.getElementById('countdown');
        const resultEl = document.getElementById('result-text');
        const btn = document.getElementById('draw-btn');
        const historyList = document.getElementById('history-list');
        const turnTitle = document.getElementById('turn-title');

        giftIcon.classList.remove('shake');
        giftIcon.style.display = 'none';
        countEl.style.display = 'none';

        const result = pool[currentIdx];
        resultEl.innerText = result;
        resultEl.style.display = 'block';
        
        // Th√™m v√†o l·ªãch s·ª≠
        const log = document.createElement('div');
        log.innerHTML = `L∆∞·ª£t ${currentIdx + 1}: <b>${result}</b>`;
        historyList.prepend(log);

        currentIdx++;
        turnTitle.innerText = `L∆∞·ª£t c√≤n l·∫°i: ${25 - currentIdx}`;

        if (currentIdx < 25) {
            btn.disabled = false;
            btn.innerText = "TI·∫æP T·ª§C B·ªêC";
        } else {
            btn.innerText = "ƒê√É H·∫æT L∆Ø·ª¢T";
            btn.style.background = "#95a5a6";
        }
    }
</script>

</body>
</html>
